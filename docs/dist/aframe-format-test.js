
window.storyFormat({
    "name": "TwineSpace",
    "version": "1.0.0",
    "author": "Dan Cox",
    "description": "A story format for creating 3D and VR stories using A-Frame.",
    "proofing": false,
    "source": "<!DOCTYPE html>\n<html>\n    <head>\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n        <title>{{STORY_NAME}}</title>\n        <style>body{font-size:2em}a,tw-link{color:blue;cursor:pointer;text-decoration:underline}a-scene{height:80%;left:0;position:absolute;top:0;transition:opacity 2s ease;z-index:999}tw-story{background:transparent;color:#fff;height:20%;padding:0;pointer-events:none;z-index:1}tw-passage{background:#000;border:6px double #fff;color:#fff;font-size:1em;line-height:1em;margin:auto 2vw 2em;max-height:40vh;overflow:auto;padding:1vw;pointer-events:auto;width:calc(94vw - 12px);z-index:1}.centered,tw-passage{bottom:0;left:0;position:fixed}.centered{transform:translate(0);width:100vw;z-index:1000}.arjs-loader{align-items:center;background-color:rgba(0,0,0,.8);display:flex;height:50%;justify-content:center;left:0;position:absolute;top:0;width:50%;z-index:9999}.arjs-loader div{color:#fff;font-size:1.25em;text-align:center}</style>\n        <script>\nconsole.log('Loading A-Frame from CDN...');\nvar script = document.createElement('script');\nscript.src = 'https://aframe.io/releases/1.4.0/aframe.min.js';\nscript.onload = function() {\n    console.log('A-Frame loaded from CDN');\n    window.loadAFrame = function() { return Promise.resolve(); };\n};\nscript.onerror = function() {\n    console.error('Failed to load A-Frame from CDN');\n};\ndocument.head.appendChild(script);\n</script>\n    </head>\n    <body>\n        {{STORY_DATA}}\n        <script>(()=>{var e,t={3439:(e,t,r)=>{\"use strict\";function n(e){return n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?e=>typeof e:e=>e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e,n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function a(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,\"prototype\",{writable:!1}),e}function i(e){var t=(e=>{if(\"object\"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,\"string\");if(\"object\"!=n(r))return r;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return String(e)})(e);return\"symbol\"==n(t)?t:t+\"\"}r.r(t),r(2675),r(9463),r(2259),r(5700),r(3792),r(9572),r(2010),r(2892),r(6099),r(7764),r(2953),e=r.hmd(e);var s=a((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"Default\",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"\";((e,t)=>{if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(this,e),this.name=t,this.tags=r,this.source=n}));e.exports=s},4319:(e,t,r)=>{\"use strict\";function n(e){return n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?e=>typeof e:e=>e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e,n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=(e=>{if(\"object\"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,\"string\");if(\"object\"!=n(r))return r;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return String(e)})(e);return\"symbol\"==n(t)?t:t+\"\"}r.r(t),r(2675),r(9463),r(2259),r(5700),r(8706),r(3792),r(9572),r(2892),r(6099),r(7764),r(2953),e=r.hmd(e);var i=r(3270),s=function(){return e=function e(){((e,t)=>{if(!(this instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(0,e)},t=[{key:\"createScene\",value:()=>(0===i(\"a-scene\").length&&i(document.body).append(i('<a-scene vr-mode-ui=\"enabled: false\" arjs=\"debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;\" />')),i(\"a-scene\"))},{key:\"add\",value:(e,t,r)=>{if(0===i(e).length)throw new Error(\"Parent element does not exist!\");var n=i(\"<a-\".concat(t,\" \").concat(r,\" />\"));return e.append(n),n}},{key:\"removeScene\",value:()=>{i(\"a-scene\").remove()}}],null&&o(e.prototype,null),t&&o(e,t),Object.defineProperty(e,\"prototype\",{writable:!1}),e;var e,t}();e.exports=s},4782:(e,t,r)=>{\"use strict\";function n(e){return n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?e=>typeof e:e=>e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e,n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=(e=>{if(\"object\"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,\"string\");if(\"object\"!=n(r))return r;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return String(e)})(e);return\"symbol\"==n(t)?t:t+\"\"}r.r(t),r(2675),r(9463),r(2259),r(5700),r(2008),r(4423),r(3792),r(9572),r(2010),r(2892),r(6099),r(1699),r(7764),r(3500),r(2953),e=r.hmd(e);var i=r(3270),s=r(4155),l=r(3439),c=r(4914),u=function(){return e=function e(){var t=this;((e,t)=>{if(!(this instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(0,e),this.storyDataElement=i(\"tw-storydata\"),this.name=this.storyDataElement.attr(\"name\"),this.creator=this.storyDataElement.attr(\"creator\"),this.creatorVersion=this.storyDataElement.attr(\"creator-version\"),this.passages=[],this.storyDataElement.children(\"tw-passagedata\").each(((e,r)=>{var n=i(r),o=n.attr(\"tags\");o=\"\"!==o&&void 0!==o?o.split(\" \"):[],t.passages.push(new l(n.attr(\"name\"),o,c.unescape(n.html())))})),this.userScripts=[],i('*[type=\"text/twine-javascript\"]').each(((e,r)=>{t.userScripts.push(i(r).html())})),this.userStyles=[],i('*[type=\"text/twine-css\"]').each(((e,r)=>{t.userStyles.push(i(r).html())})),this.storyElement=i(\"tw-story\"),this.storyElement.on(\"click\",\"tw-link[data-passage]\",(e=>{var r=c.unescape(i(e.target).closest(\"[data-passage]\").data(\"passage\"));t.show(r)})),this.passageElement=i(\"tw-passage\")},(t=[{key:\"include\",value:function(e){var t=this.getPassageByName(e);if(null===t)throw new Error(\"Passage does not exist!\");return t.source}},{key:\"start\",value:function(){this.userStyles.forEach((e=>{i(document.body).append(\"<style>\".concat(e,\"</style>\"))})),this.userScripts.forEach((e=>{try{s.render(\"<%\".concat(e,\"%>\"),{$:i})}catch(t){throw new Error(\"User script error: \".concat(t))}})),this.getPassagesByTag(\"script\").forEach((e=>{try{s.render(\"<%\".concat(e.source,\"%>\"),{$:i})}catch(t){throw new Error(\"User script error: \".concat(t))}}));var e=parseInt(this.storyDataElement.attr(\"startnode\")),t=i('[pid=\"'.concat(e,'\"]'));if(0===t.length)throw new Error(\"Starting passage not found!\");this.show(t.attr(\"name\"))}},{key:\"show\",value:function(e){var t=this.getPassageByName(e);if(null===t)throw new Error(\"There is no passage with the name \".concat(e));this.passageElement.attr(\"tags\",t.tags);try{t.source=s.render(t.source,{$:i},{outputFunctionName:\"echo\"})}catch(r){throw new Error(\"User script error: \".concat(r))}this.passageElement.html(c.parse(t.source))}},{key:\"getPassagesByTag\",value:function(e){return this.passages.filter((t=>t.tags.includes(e)))}},{key:\"getPassageByName\",value:function(e){var t=null,r=this.passages.filter((t=>t.name===e));return 0!==r.length&&(t=r[0]),t}}])&&o(e.prototype,t),Object.defineProperty(e,\"prototype\",{writable:!1}),e;var e,t}();e.exports=u},4914:(e,t,r)=>{\"use strict\";function n(e){return n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?e=>typeof e:e=>e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e,n(e)}function o(e,t){return(e=>{if(Array.isArray(e))return e})(e)||((e,t)=>{var r=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=r){var n,o,a,i,s=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw o}}return s}})(e,t)||((e,t)=>{if(e){if(\"string\"==typeof e)return a(e,t);var r={}.toString.call(e).slice(8,-1);return\"Object\"===r&&e.constructor&&(r=e.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}})(e,t)||(()=>{throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")})()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);t>r;r++)n[r]=e[r];return n}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=(e=>{if(\"object\"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,\"string\");if(\"object\"!=n(r))return r;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return String(e)})(e);return\"symbol\"==n(t)?t:t+\"\"}r.r(t),r(2675),r(9463),r(2259),r(5700),r(3418),r(3792),r(2401),r(9572),r(2010),r(2892),r(6099),r(7495),r(8781),r(7764),r(5440),r(2762),r(2041),r(2953),e=r.hmd(e);var l=r(4319),c=r(3270),u=r(383)({html:!0,linkify:!0,typographer:!0}),y=function(){return e=function e(){((e,t)=>{if(!(this instanceof t))throw new TypeError(\"Cannot call a class as a function\")})(0,e)},t=[{key:\"parse\",value:e=>(l.removeScene(),[[/\\[\\[(.*?)\\|(.*?)\\]\\]/g,'<tw-link role=\"link\" data-passage=\"$2\">$1</tw-link>'],[/\\[\\[(.*?)->(.*?)\\]\\]/g,'<tw-link role=\"link\" data-passage=\"$2\">$1</tw-link>'],[/\\[\\[(.*?)<-(.*?)\\]\\]/g,'<tw-link role=\"link\" data-passage=\"$1\">$2</tw-link>'],[/\\[\\[(.*?)\\]\\]/g,'<tw-link role=\"link\" data-passage=\"$1\">$1</tw-link>'],[/\\((.*?):([^>]*?)\\)\\[([^>]*?)\\]/gim,(e,t,r,n)=>{var o=l.createScene(),a=l.add(o,t,r);return n.replace(/\\((.*?):([^>]*?)\\)/gim,((e,t,r)=>(l.add(a,t,r),\"\"))),\"\"}],[/\\((.*?):([^>]*?)\\)/gim,(e,t,r)=>{if(\"embed-scene\"===t.toLowerCase()){var n=r.trim(),o=n.slice(1,n.length-1),a=window.story.include(o);return c(document.body).append(a),\"\"}var i=l.createScene();return l.add(i,t,r),\"\"}],[/[\\r\\n\\n]/g,\"<br>\"]].forEach((t=>{var r=o(t,2),n=r[0],a=r[1];e=e.replace(n,a)})),c(\"a-marker\").length>0&&c(\"a-scene\").add(\"<a-entity camera>\"),u.renderInline(e))},{key:\"unescape\",value:e=>([[\"&amp;\",\"&\"],[\"&lt;\",\"<\"],[\"&gt;\",\">\"],[\"&quot;\",'\"'],[\"&#x27;\",\"'\"],[\"&#x60;\",\"`\"]].forEach((t=>{var r=o(t,2),n=r[0],a=r[1];e=e.replaceAll(n,a)})),e)}],null&&i(e.prototype,null),t&&i(e,t),Object.defineProperty(e,\"prototype\",{writable:!1}),e;var e,t}();e.exports=y},5369:(e,t,r)=>{\"use strict\";var n=r(3270),o=r(4782);window.$=n,window.story=new o,window.story.start()},7024:()=>{},7280:()=>{}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var a=r[e]={id:e,loaded:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,e=[],n.O=(t,r,o,a)=>{if(!r){var i=1/0;for(u=0;u<e.length;u++){for(var[r,o,a]=e[u],s=!0,l=0;l<r.length;l++)(!1&a||i>=a)&&Object.keys(n.O).every((e=>n.O[e](r[l])))?r.splice(l--,1):(s=!1,i>a&&(i=a));if(s){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,o,a]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if(\"object\"==typeof globalThis)return globalThis;try{return this||new Function(\"return this\")()}catch(e){if(\"object\"==typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,\"exports\",{enumerable:!0,set:()=>{throw new Error(\"ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: \"+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.j=114,(()=>{var e={114:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,a,[i,s,l]=r,c=0;if(i.some((t=>0!==e[t]))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(l)var u=l(n)}for(t&&t(r);c<i.length;c++)a=i[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},r=self.webpackChunktwinespace=self.webpackChunktwinespace||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var o=n.O(void 0,[881,96],(()=>n(5369)));o=n.O(o)})();</script>\n    </body>\n</html>"
});
